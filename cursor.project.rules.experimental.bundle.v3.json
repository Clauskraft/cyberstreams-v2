{
  "type": "cursor.project.rules",
  "version": 1,
  "rules": [
    {
      "name": "Experimental Modules Bundle v3",
      "scope": "project",
      "text": "The following JSON defines experimental modules, agent, checklists, and UI defaults. Agents must read and follow it.\n\n```json\n{\n  \"type\": \"cyberstreams.experimental.bundle\",\n  \"version\": 3,\n  \"ui_defaults\": {\n    \"probabilities\": true,\n    \"show_ci\": true,\n    \"severity_thresholds\": {\n      \"warn\": 0.6,\n      \"alert\": 0.8,\n      \"critical\": 0.92\n    },\n    \"viz\": {\n      \"edges\": {\n        \"show_p\": true,\n        \"show_ci\": true,\n        \"thickness_by_p\": true\n      },\n      \"nodes\": {\n        \"halo_by_choke_prob\": true,\n        \"labels_show_uncertainty\": true\n      },\n      \"alerts\": {\n        \"include_p_and_ci\": true,\n        \"include_evidence\": true\n      }\n    }\n  },\n  \"output_schema\": {\n    \"type\": \"object\",\n    \"required\": [\n      \"id\",\n      \"ts\",\n      \"module\",\n      \"kind\",\n      \"summary\",\n      \"p\",\n      \"ci\",\n      \"severity\",\n      \"evidence\",\n      \"explain\"\n    ],\n    \"properties\": {\n      \"id\": {\n        \"type\": \"string\"\n      },\n      \"ts\": {\n        \"type\": \"string\",\n        \"format\": \"date-time\"\n      },\n      \"module\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"appe\",\n          \"chfde\",\n          \"tgaiku\"\n        ]\n      },\n      \"kind\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"alert\",\n          \"graph\",\n          \"report\",\n          \"telemetry\"\n        ]\n      },\n      \"summary\": {\n        \"type\": \"string\"\n      },\n      \"p\": {\n        \"type\": \"number\",\n        \"minimum\": 0,\n        \"maximum\": 1\n      },\n      \"ci\": {\n        \"type\": \"array\",\n        \"items\": {\n          \"type\": \"number\"\n        },\n        \"minItems\": 2,\n        \"maxItems\": 2\n      },\n      \"severity\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"low\",\n          \"medium\",\n          \"high\",\n          \"critical\"\n        ]\n      },\n      \"evidence\": {\n        \"type\": \"array\",\n        \"items\": {\n          \"type\": \"object\"\n        }\n      },\n      \"explain\": {\n        \"type\": \"object\"\n      },\n      \"uncertainty\": {\n        \"type\": \"object\"\n      },\n      \"calibration\": {\n        \"type\": \"object\"\n      },\n      \"links\": {\n        \"type\": \"array\",\n        \"items\": {\n          \"type\": \"string\"\n        }\n      }\n    }\n  },\n  \"calibration_policy\": {\n    \"training\": \"Platt or isotonic on validation; Bayesian beta prior for sparse edges\",\n    \"report\": [\n      \"brier\",\n      \"ece\",\n      \"auroc\",\n      \"aupr\"\n    ],\n    \"thresholds\": {\n      \"warn\": 0.6,\n      \"alert\": 0.8,\n      \"critical\": 0.92\n    }\n  },\n  \"modules\": [\n    {\n      \"id\": \"appe\",\n      \"name\": \"Adversary Simulation & Predictive Pathing Engine\",\n      \"purpose\": \"Forudsige mest sandsynlige angrebsveje pr. aktør via Bayesian Attack Graphs + RL/POMDP.\",\n      \"assumptions\": [\n        \"Angriber-adfærd ≈ POMDP med skjulte tilstande.\",\n        \"Kant-sandsynligheder estimeres fra sårbarheder og historik.\",\n        \"Aktør-præferencer læres via IRL eller historiske sekvenser.\"\n      ],\n      \"algorithms\": {\n        \"graphs\": [\n          \"Dynamic Bayesian Networks (DBN) for kantposterior\",\n          \"Top-k path inference (Yen) vægtet af posterior\"\n        ],\n        \"rl\": [\n          \"PPO (discrete) med action-masking\",\n          \"MCTS guidet af policy for lookahead\",\n          \"Bayesian IRL for reward pr. aktør\"\n        ],\n        \"probability\": [\n          \"Path-p = prod(edge_p) med log-sum-exp\",\n          \"Credible intervals via Beta-prior per edge\"\n        ],\n        \"calibration\": [\n          \"Platt scaling på path-scorer\",\n          \"Isotonic ved nok labels\"\n        ]\n      },\n      \"outputs\": {\n        \"graph_overlay\": \"nodes/edges med p og 95% CI; edge thickness ~ p; node halo ~ choke prob\",\n        \"warnings\": \"MLAP + top-3 alternativer med p og CI\",\n        \"api\": [\n          \"/api/v1/appe/simulate\",\n          \"/api/v1/appe/paths\",\n          \"/api/v1/appe/alerts\"\n        ]\n      },\n      \"data_requirements\": [\n        \"Assets\",\n        \"Vulnerabilities (CVSS/KEV)\",\n        \"Incidents historik\",\n        \"MITRE TTP-profiler\"\n      ],\n      \"evaluation\": {\n        \"metrics\": [\n          \"Top-k path hit rate\",\n          \"Brier\",\n          \"ECE\",\n          \"TTR (time-to-recommendation)\"\n        ],\n        \"offline\": \"Replay mod historik\",\n        \"online\": \"Analyst feedback loop\"\n      },\n      \"risk_controls\": [\n        \"Compute cap\",\n        \"Human-in-the-loop\",\n        \"Audit logs for seed/RNG\"\n      ],\n      \"acceptance_criteria\": [\n        \"Top-5 path rammer korrekt næste hop i ≥70% af cases\",\n        \"Brier ≤ 0.20\",\n        \"Explain payload viser top-5 edge-bidrag\"\n      ],\n      \"checklist\": {\n        \"preconditions\": [\n          \"Asset- og vuln-dækning ≥ 80%\",\n          \"TTP-profiler for mål-aktører tilgængelige\",\n          \"Basal kalibreringsdataset klar\"\n        ],\n        \"run\": [\n          \"Træn/kalibrér policy\",\n          \"Kør simuleringer (≥1000) pr. aktør\",\n          \"Generér MLAP + top-3 med p, CI\"\n        ],\n        \"accept\": [\n          \"Metrics: Brier/ECE opfylder krav\",\n          \"Explainability genereres for alle MLAP\",\n          \"Analyst QA sign-off\"\n        ],\n        \"fail_criteria\": [\n          \"ECE > 0.1 efter kalibrering\",\n          \"Top-k hit rate < 0.5\",\n          \"Manglende explain payload\"\n        ]\n      }\n    },\n    {\n      \"id\": \"chfde\",\n      \"name\": \"Cognitive HUMINT Fusion & Deception Engine\",\n      \"purpose\": \"LLM-fusion af HUMINT og automatiseret, målrettet deception.\",\n      \"assumptions\": [\n        \"Tekstsignaler kan profilere aktører uden PII.\",\n        \"Interaktioner med honeytokens kan probabilistisk vurderes.\"\n      ],\n      \"algorithms\": {\n        \"nlp\": [\n          \"RAG over HUMINT-korpus\",\n          \"Zero/few-shot intent/motive classifiers\",\n          \"CTM topic modeling for discourse\"\n        ],\n        \"deception\": [\n          \"Honeytokens m. canary-domæner\",\n          \"Scenario-honeypots\",\n          \"Policy-bundet adaptiv content\"\n        ],\n        \"probability\": [\n          \"Logistic/GBM P(malicious|features)\",\n          \"Bayesian update over gentagne hits\"\n        ],\n        \"calibration\": [\n          \"Isotonic kalibrering mod telmetry labels\"\n        ]\n      },\n      \"outputs\": {\n        \"campaign_briefs\": \"Profiler + anbefalede lokkeduer m. forventet utility p\",\n        \"telemetry\": \"session features + p(malicious) + CI + risk band\",\n        \"api\": [\n          \"/api/v1/chfde/generate\",\n          \"/api/v1/chfde/deploy\",\n          \"/api/v1/chfde/telemetry\"\n        ]\n      },\n      \"ethical_legal\": [\n        \"Ingen PII i artefakter\",\n        \"Juridisk godkendelse før aktivering\",\n        \"Isoleret net for deception-assets\"\n      ],\n      \"evaluation\": {\n        \"metrics\": [\n          \"Precision@k for sessions\",\n          \"Brier\",\n          \"ECE\"\n        ],\n        \"ablation\": \"Artefakt-effekt på engagement-rate\"\n      },\n      \"risk_controls\": [\n        \"Feature flags\",\n        \"Read-only capture\",\n        \"Timeout/budget pr. kampagne\"\n      ],\n      \"acceptance_criteria\": [\n        \"ECE ≤ 0.07\",\n        \"Rollback < 5 min\",\n        \"QA-checkliste opfyldt\"\n      ],\n      \"checklist\": {\n        \"preconditions\": [\n          \"Godkendt juridisk scope og DPIA\",\n          \"Renset HUMINT-korpus i RAG store\",\n          \"Canary-domæner provisioneret\"\n        ],\n        \"run\": [\n          \"Generér deception-artefakter\",\n          \"Deploy i staging\",\n          \"Aktivér telemetry og kalibrering\"\n        ],\n        \"accept\": [\n          \"Precision@k og ECE opfylder krav\",\n          \"Ingen PII lækket\",\n          \"Rollback testet\"\n        ],\n        \"fail_criteria\": [\n          \"Telemetry mangler CI\",\n          \"PII fundet i artefakter\",\n          \"ECE > 0.1\"\n        ]\n      }\n    },\n    {\n      \"id\": \"tgaiku\",\n      \"name\": \"Temporal Graph AI & Kill Chain Unraveler\",\n      \"purpose\": \"Detektere og forklare kampagner som anomale subgrafer.\",\n      \"assumptions\": [\n        \"Normal adfærd kan læres som tidslig embedding\",\n        \"Kampagner danner afvigende subgrafer\"\n      ],\n      \"algorithms\": {\n        \"temporal_gnn\": [\n          \"TGAT/TGN\",\n          \"DySAT\"\n        ],\n        \"subgraph_detection\": [\n          \"Windowed streaming + MIDAS\",\n          \"Contrastive subgraph score\"\n        ],\n        \"probability\": [\n          \"Sigmoid-kalibreret p(campaign)\",\n          \"Bayes-fusion over vinduer\"\n        ],\n        \"explainability\": [\n          \"GNNExplainer/PGExplainer\",\n          \"Saliency heatmaps\"\n        ]\n      },\n      \"outputs\": {\n        \"subgraph_alert\": \"p + 95% CI, nodes/edges, kill-chain faser\",\n        \"viz\": \"edge-opacity ~ p; labels med uncertainty\",\n        \"api\": [\n          \"/api/v1/tgaiku/score\",\n          \"/api/v1/tgaiku/subgraph\",\n          \"/api/v1/tgaiku/explain\"\n        ]\n      },\n      \"data_requirements\": [\n        \"Logs/flows/identity m. timestamp\",\n        \"≥14 dages baseline\",\n        \"Asset/identity mapping\"\n      ],\n      \"evaluation\": {\n        \"metrics\": [\n          \"AUROC/AUPR\",\n          \"Brier/ECE\",\n          \"TTD (time-to-detection)\"\n        ],\n        \"validation\": \"Canary incidents + red team replays\"\n      },\n      \"risk_controls\": [\n        \"Compute/storage budgetter\",\n        \"Explainability påkrævet for alerts\",\n        \"Shadow-mode før auto-action\"\n      ],\n      \"acceptance_criteria\": [\n        \"Precision ≥ 0.75 ved threshold\",\n        \"ECE ≤ 0.05\",\n        \"Explain payload leveres for alle alerts\"\n      ],\n      \"checklist\": {\n        \"preconditions\": [\n          \"Baseline-data ≥ 14 dage\",\n          \"Event-normalisering på plads\",\n          \"Vis- og eval-metrics defineret\"\n        ],\n        \"run\": [\n          \"Træn GNN embeddings\",\n          \"Kalibrér scores\",\n          \"Aktivér shadow-mode og log ECE\"\n        ],\n        \"accept\": [\n          \"Precision/ECE opfylder krav\",\n          \"Explain viz ok\",\n          \"Analyst sign-off\"\n        ],\n        \"fail_criteria\": [\n          \"ECE > 0.08\",\n          \"Explain mangler\",\n          \"TTD ikke forbedret mod baseline\"\n        ]\n      }\n    }\n  ],\n  \"agent\": {\n    \"id\": \"experimental-module-agent\",\n    \"role\": \"Styrer modul-livscyklus: scaffold → dataset → train → calibrate → deploy → shadow → promote → retire\",\n    \"prompts\": {\n      \"scaffold\": \"Opret apps/experimental/{module_id} med service, OpenAPI, Make targets, README, acceptance og eval-metrics.\",\n      \"dataset\": \"Lav datasæt-manifest + synthetic samples. Ingen PII. Dokumentér features og labeling.\",\n      \"train\": \"Træn staged model. Gem AUROC/AUPR/Brier/ECE + logs/artifacts.\",\n      \"calibrate\": \"Kør Platt/isotonic; gem kalibreringskurver og opdater serving.\",\n      \"deploy\": \"Deploy til Railway staging experimental-{module_id}-stg; aktiver shadow-mode.\",\n      \"promote\": \"Åbn PR til produktion hvis acceptance opfyldes.\"\n    },\n    \"constraints\": [\n      \"Returnér altid p + 95% CI i API\",\n      \"Ingen dark-web/PII uden eksplicit godkendelse\",\n      \"Log Brier/ECE pr. release\"\n    ]\n  }\n}\n```"
    },
    {
      "name": "Experimental UI Policy",
      "scope": "project",
      "text": "All graphs and warnings MUST show calibrated probabilities (p) and 95% CI. Severity thresholds: warn=0.6, alert=0.8, critical=0.92. Include evidence and explainability payload in every alert."
    },
    {
      "name": "Experimental Lifecycle",
      "scope": "project",
      "text": "Lifecycle: scaffold → dataset → train → calibrate → deploy → shadow → promote → retire. Shadow-mode mandatory before any auto-action. Promotion requires ECE/precision to meet acceptance and analyst sign-off."
    }
  ]
}